<!DOCTYPE html><html><head><meta charset="utf-8"><title>教学讲义 | 技术学派</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="第一章 ThinkPHP简介第一节 获取1. 地址http://www.thinkphp.cn/down/610.htmlcomposer安装命令：composer create-project topthink/thinkphp your-project-name2. 安装安装真的是so easy，我们只需要将下载下来的压缩包进行解压，并且放到相应的服务器根目录下，即可直接来进行使用啦！3. 访"><meta property="og:type" content="website"><meta property="og:title" content="教学讲义"><meta property="og:url" content="http://www.JiShuXuePai.com/tech/thinkphp/notes.html"><meta property="og:site_name" content="技术学派"><meta property="og:description" content="第一章 ThinkPHP简介第一节 获取1. 地址http://www.thinkphp.cn/down/610.htmlcomposer安装命令：composer create-project topthink/thinkphp your-project-name2. 安装安装真的是so easy，我们只需要将下载下来的压缩包进行解压，并且放到相应的服务器根目录下，即可直接来进行使用啦！3. 访"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="http://www.thinkphp.cn/Uploads/info/hello.jpg"><meta property="og:updated_time" content="2018-05-11T08:14:19.388Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="教学讲义"><meta name="twitter:description" content="第一章 ThinkPHP简介第一节 获取1. 地址http://www.thinkphp.cn/down/610.htmlcomposer安装命令：composer create-project topthink/thinkphp your-project-name2. 安装安装真的是so easy，我们只需要将下载下来的压缩包进行解压，并且放到相应的服务器根目录下，即可直接来进行使用啦！3. 访"><meta name="twitter:image" content="http://www.thinkphp.cn/Uploads/info/hello.jpg"><link rel="stylesheet" href="/libs/bootstrap/bootstrap-grid.css"><link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="/libs/titillium-web/styles.css"><link rel="stylesheet" href="/libs/source-code-pro/styles.css"><link rel="stylesheet" href="/css/style.css"><script src="/libs/jquery/jquery.min.js"></script><link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css"><link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css"><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="//hm.baidu.com/hm.js?4c1bd812de3c30edbaa2b803c66f0a04";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></head></html><body><div id="wrap"><header id="header"><div id="header-outer" class="outer"><div class="container"><div class="container-inner"><div id="header-title"><h1 class="logo-wrap"><a href="/" class="logo"></a></h1></div><div id="header-inner" class="nav-container"><a id="main-nav-toggle" class="nav-icon fa fa-bars">菜单</a><div class="nav-container-inner"><ul id="main-nav"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/">主页</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/edu/index.html">学编程</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/blog/">博客</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/nav.html">网站导航</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/tips.html">学习建议</a></li></ul><nav id="sub-nav"><div id="search-form-wrap"><form class="search-form"><input type="text" class="ins-search-input search-form-input" placeholder="搜索"> <button type="submit" class="search-form-submit"></button></form><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" class="ins-search-input" placeholder="想要查找什么..."> <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"文章",PAGES:"页面",CATEGORIES:"分类",TAGS:"标签",UNTITLED:"(未命名)"},ROOT_URL:"/",CONTENT_URL:"/content.json"}</script><script src="/js/insight.js"></script></div></nav></div></div></div></div></div></header><div class="container"><div class="main-body container-inner"><div class="main-body-inner"><section id="main"><div class="main-body-header"><h1 class="header"><em class="page-title-link" data-url="/tech/thinkphp/notes.html">教学讲义</em><div class="author"></div></h1></div><div class="main-body-content"><article id="page-" class="article article-single article-type-page" itemscope itemprop="blogPost"><div class="article-inner"><header class="article-header"><h1 class="article-title" itemprop="name">教学讲义</h1></header><div class="article-entry" itemprop="articleBody"><h1 id="第一章-ThinkPHP简介"><a href="#第一章-ThinkPHP简介" class="headerlink" title="第一章 ThinkPHP简介"></a>第一章 ThinkPHP简介</h1><h2 id="第一节-获取"><a href="#第一节-获取" class="headerlink" title="第一节 获取"></a>第一节 获取</h2><h3 id="1-地址"><a href="#1-地址" class="headerlink" title="1. 地址"></a>1. 地址</h3><ul><li><a href="http://www.thinkphp.cn/down/610.html" target="_blank" rel="noopener">http://www.thinkphp.cn/down/610.html</a></li><li>composer安装命令：composer create-project topthink/thinkphp your-project-name</li></ul><h3 id="2-安装"><a href="#2-安装" class="headerlink" title="2. 安装"></a>2. 安装</h3><blockquote><p>安装真的是so easy，我们只需要将下载下来的压缩包进行解压，并且放到相应的服务器根目录下，即可直接来进行使用啦！</p></blockquote><h3 id="3-访问"><a href="#3-访问" class="headerlink" title="3. 访问"></a>3. 访问</h3><blockquote><p>在浏览器中，访问localhost本地主机，并且找到解压缩之后的目录，即可看到框架加载成功的界面了！是一个很可爱的小笑脸！能够看到他，说明你的TP框架已经安装成功！</p></blockquote><h2 id="第二节-目录结构"><a href="#第二节-目录结构" class="headerlink" title="第二节 目录结构"></a>第二节 目录结构</h2><h3 id="1-结构"><a href="#1-结构" class="headerlink" title="1. 结构"></a>1. 结构</h3><ul><li>未访问该框架的时候，目录结构如下</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">www  WEB部署目录（或者子目录）</span><br><span class="line">├─index.php       入口文件</span><br><span class="line">├─README.md       README文件</span><br><span class="line">├─Application     应用目录</span><br><span class="line">├─<span class="keyword">Public</span>          资源文件目录</span><br><span class="line">└─ThinkPHP        框架目录</span><br></pre></td></tr></table></figure><ul><li>框架目录ThinkPHP结构如下！</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">├─ThinkPHP 框架系统目录（可以部署在非web目录下面）</span><br><span class="line">│  ├─Common       核心公共函数目录</span><br><span class="line">│  ├─Conf         核心配置目录 </span><br><span class="line">│  ├─Lang         核心语言包目录</span><br><span class="line">│  ├─Library      框架类库目录</span><br><span class="line">│  │  ├─Think     核心Think类库包目录</span><br><span class="line">│  │  ├─Behavior  行为类库目录</span><br><span class="line">│  │  ├─Org       Org类库包目录</span><br><span class="line">│  │  ├─Vendor    第三方类库目录</span><br><span class="line">│  │  ├─ ...      更多类库目录</span><br><span class="line">│  ├─Mode         框架应用模式目录</span><br><span class="line">│  ├─Tpl          系统模板目录</span><br><span class="line">│  ├─LICENSE.txt  框架授权协议文件</span><br><span class="line">│  ├─logo.png     框架LOGO文件</span><br><span class="line">│  ├─README.txt   框架README文件</span><br><span class="line">│  └─ThinkPHP.php    框架入口文件</span><br></pre></td></tr></table></figure><h3 id="2-创建应用"><a href="#2-创建应用" class="headerlink" title="2. 创建应用"></a>2. 创建应用</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 应用入口文件</span></span><br><span class="line"><span class="comment">// 检测PHP环境</span></span><br><span class="line"><span class="keyword">if</span>(version_compare(PHP_VERSION,<span class="string">'5.3.0'</span>,<span class="string">'&lt;'</span>))  <span class="keyword">die</span>(<span class="string">'require PHP &gt; 5.3.0 !'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 开启调试模式 建议开发阶段开启 部署阶段注释或者设为false</span></span><br><span class="line">define(<span class="string">'APP_DEBUG'</span>,<span class="keyword">True</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义应用目录（修改这里的内容，就可以创建你想要的应用名称）</span></span><br><span class="line">define(<span class="string">'APP_PATH'</span>,<span class="string">'./Web1709/'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入ThinkPHP入口文件</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">'./ThinkPHP/ThinkPHP.php'</span>;</span><br></pre></td></tr></table></figure><h3 id="3-其他设置"><a href="#3-其他设置" class="headerlink" title="3. 其他设置"></a>3. 其他设置</h3><table><thead><tr><th>常量</th><th>描述</th></tr></thead><tbody><tr><td>THINK_PATH</td><td>框架目录</td></tr><tr><td>APP_PATH</td><td>应用目录</td></tr><tr><td>RUNTIME_PATH</td><td>应用运行时目录（可写）</td></tr><tr><td>APP_DEBUG</td><td>应用调试模式 （默认为false）</td></tr><tr><td>STORAGE_TYPE</td><td>存储类型（默认为File）</td></tr><tr><td>APP_MODE</td><td>应用模式（默认为common）</td></tr></tbody></table><h2 id="第三节-自动生成"><a href="#第三节-自动生成" class="headerlink" title="第三节 自动生成"></a>第三节 自动生成</h2><p><img src="http://www.thinkphp.cn/Uploads/info/hello.jpg" alt="img"></p><h3 id="1-应用目录结构"><a href="#1-应用目录结构" class="headerlink" title="1.应用目录结构"></a>1.应用目录结构</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">web1709</span><br><span class="line">├─Common         应用公共模块</span><br><span class="line">│  ├─Common      应用公共函数目录</span><br><span class="line">│  └─Conf        应用公共配置文件目录</span><br><span class="line">├─Home           默认生成的Home模块</span><br><span class="line">│  ├─Conf        模块配置文件目录</span><br><span class="line">│  ├─Common      模块函数公共目录</span><br><span class="line">│  ├─Controller  模块控制器目录</span><br><span class="line">│  ├─Model       模块模型目录</span><br><span class="line">│  └─View        模块视图文件目录</span><br><span class="line">├─Runtime        运行时目录</span><br><span class="line">│  ├─Cache       模版缓存目录</span><br><span class="line">│  ├─Data        数据目录</span><br><span class="line">│  ├─Logs        日志目录</span><br><span class="line">│  └─Temp        缓存目录</span><br></pre></td></tr></table></figure><h3 id="2-安全文件"><a href="#2-安全文件" class="headerlink" title="2. 安全文件"></a>2. 安全文件</h3><h1 id="第二章-模块设计"><a href="#第二章-模块设计" class="headerlink" title="第二章 模块设计"></a>第二章 模块设计</h1><h2 id="第一节-模块划分"><a href="#第一节-模块划分" class="headerlink" title="第一节 模块划分"></a>第一节 模块划分</h2><h3 id="1-目录结构"><a href="#1-目录结构" class="headerlink" title="1. 目录结构"></a>1. 目录结构</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">web1709      	 我们的目录（可以设置）</span><br><span class="line">├─Common         公共模块（不能直接访问）</span><br><span class="line">├─Home           前台模块</span><br><span class="line">├─Admin          后台模块</span><br><span class="line">├─...            其他更多模块</span><br><span class="line">├─Runtime        默认运行时目录（可以设置）</span><br></pre></td></tr></table></figure><h3 id="2-MVC详解"><a href="#2-MVC详解" class="headerlink" title="2. MVC详解"></a>2. MVC详解</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">├─Home           默认生成的Home模块</span><br><span class="line">│  ├─Conf        模块配置文件目录</span><br><span class="line">│  ├─Common      模块函数公共目录</span><br><span class="line">│  ├─Controller  模块控制器目录</span><br><span class="line">│  │  ├─IndexController.class.php</span><br><span class="line">│  ├─Model       模块模型目录</span><br><span class="line">│  └─View        模块视图文件目录</span><br></pre></td></tr></table></figure><h4 id="2-1-控制器"><a href="#2-1-控制器" class="headerlink" title="2.1 控制器"></a>2.1 控制器</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//默认Index控制器的内容，若我们对index方法的内容进行了修改</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Home</span>\<span class="title">Controller</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Think</span>\<span class="title">Controller</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IndexController</span> <span class="keyword">extends</span> <span class="title">Controller</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'hello,world!'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-2-视图"><a href="#2-2-视图" class="headerlink" title="2.2 视图"></a>2.2 视图</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">├─View           前台模板存储目录</span><br><span class="line">│  ├─Index       默认存储前台主页信息的目录</span><br><span class="line">│  ├─User		 前台用户管理目录     </span><br><span class="line">│  │  ├─index.html		用户中心模板</span><br><span class="line">│  │  ├─add.html		用户添加模板</span><br><span class="line">│  │  ├─edit.html		用户修改模板</span><br><span class="line">│  ├─Goods  	 前台商品目录</span><br><span class="line">│  ├─Model       模块模型目录</span><br><span class="line">│  └─View        模块视图文件目录</span><br></pre></td></tr></table></figure><h4 id="2-3-模型"><a href="#2-3-模型" class="headerlink" title="2.3 模型"></a>2.3 模型</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Home</span>\<span class="title">Model</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Think</span>\<span class="title">Model</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserModel</span> <span class="keyword">extends</span> <span class="title">Model</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>作用：<ul><li>模型类的作用大多数情况是操作数据表的，如果按照系统的规范来命名模型类的话，大多数情况下是可以自动对应数据表。</li></ul></li><li>命名<ul><li>模型类的命名规则是除去表前缀的数据表名称，采用驼峰法命名，并且首字母大写，然后加上模型层的名称（默认定义是Model），例如：</li></ul></li></ul><table><thead><tr><th>模型名</th><th>约定对应数据表（假设数据库的前缀定义是 think_）</th></tr></thead><tbody><tr><td>UserModel</td><td>think_user</td></tr><tr><td>UserTypeModel</td><td>think_user_type</td></tr></tbody></table><ul><li>数据表定义<ul><li>在ThinkPHP的模型里面，有几个关于数据表名称的属性定义：</li></ul></li></ul><table><thead><tr><th>属性</th><th>说明</th></tr></thead><tbody><tr><td>tablePrefix</td><td>定义模型对应数据表的前缀，如果未定义则获取配置文件中的DB_PREFIX参数</td></tr><tr><td>tableName</td><td>不包含表前缀的数据表名称，一般情况下默认和模型名称相同，只有当你的表名和当前的模型类的名称不同的时候才需要定义。</td></tr><tr><td>trueTableName</td><td>包含前缀的数据表名称，也就是数据库中的实际表名，该名称无需设置，只有当上面的规则都不适用的情况或者特殊情况下才需要设置。</td></tr><tr><td>dbName</td><td>定义模型当前对应的数据库名称，只有当你当前的模型类对应的数据库名称和配置文件不同的时候才需要定义。</td></tr></tbody></table><h1 id="第三章-配置"><a href="#第三章-配置" class="headerlink" title="第三章 配置"></a>第三章 配置</h1><h2 id="第一节-存放位置"><a href="#第一节-存放位置" class="headerlink" title="第一节 存放位置"></a>第一节 存放位置</h2><h3 id="1-前台配置"><a href="#1-前台配置" class="headerlink" title="1.前台配置"></a>1.前台配置</h3><blockquote><p>默认的配置文件都是存储在Conf目录当中的，前台配置文件的存放位置则为Application/Home/Conf/config.php，后台当然就是Application/Admin/Conf/config.php文件啦！但是这里我们还是建议大家在ThinkPHP/Conf/convention.php文件中去寻找相应配置，并将其复制到前后台的配置文件中，尽量不要修改ThinkPHP框架中的惯例配置文件。</p></blockquote><h2 id="第二节-定义方式"><a href="#第二节-定义方式" class="headerlink" title="第二节 定义方式"></a>第二节 定义方式</h2><h3 id="1-配置文件定义"><a href="#1-配置文件定义" class="headerlink" title="1.配置文件定义"></a>1.配置文件定义</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//项目配置文件</span></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">array</span>(</span><br><span class="line">   <span class="comment">/* 数据库设置 */</span></span><br><span class="line">    <span class="string">'DB_TYPE'</span>                =&gt; <span class="string">'mysql'</span>, <span class="comment">// 数据库类型</span></span><br><span class="line">    <span class="string">'DB_HOST'</span>                =&gt; <span class="string">'localhost'</span>, <span class="comment">// 服务器地址</span></span><br><span class="line">    <span class="string">'DB_NAME'</span>                =&gt; <span class="string">'web1709'</span>, <span class="comment">// 数据库名</span></span><br><span class="line">    <span class="string">'DB_USER'</span>                =&gt; <span class="string">'root'</span>, <span class="comment">// 用户名</span></span><br><span class="line">    <span class="string">'DB_PWD'</span>                 =&gt; <span class="string">'123'</span>, <span class="comment">// 密码</span></span><br><span class="line">    <span class="string">'DB_PORT'</span>                =&gt; <span class="string">'3306'</span>, <span class="comment">// 端口</span></span><br><span class="line">    <span class="string">'DB_PREFIX'</span>              =&gt; <span class="string">'think_'</span>, <span class="comment">// 数据库表前缀</span></span><br><span class="line">    <span class="comment">//更多配置参数</span></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3 id="2-入口文件定义"><a href="#2-入口文件定义" class="headerlink" title="2. 入口文件定义"></a>2. 入口文件定义</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">define(<span class="string">'DB_TYPE'</span>,<span class="string">'mysql'</span>);</span><br></pre></td></tr></table></figure><h2 id="第三节-加载顺序"><a href="#第三节-加载顺序" class="headerlink" title="第三节 加载顺序"></a>第三节 加载顺序</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">惯例配置-&gt;应用配置-&gt;模式配置-&gt;调试配置-&gt;状态配置-&gt;模块配置-&gt;扩展配置-&gt;动态配置</span><br></pre></td></tr></table></figure><h2 id="第四节-读取配置"><a href="#第四节-读取配置" class="headerlink" title="第四节 读取配置"></a>第四节 读取配置</h2><h3 id="1-读取方式"><a href="#1-读取方式" class="headerlink" title="1. 读取方式"></a>1. 读取方式</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$model = C(<span class="string">'DB_HOST'</span>);</span><br><span class="line"><span class="keyword">echo</span> $model;	<span class="comment">//localhost</span></span><br></pre></td></tr></table></figure><h2 id="第五节-动态配置"><a href="#第五节-动态配置" class="headerlink" title="第五节 动态配置"></a>第五节 动态配置</h2><h3 id="1-配置方式"><a href="#1-配置方式" class="headerlink" title="1. 配置方式"></a>1. 配置方式</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 动态改变缓存有效期</span></span><br><span class="line">C(<span class="string">'DATA_CACHE_TIME'</span>,<span class="number">60</span>);</span><br></pre></td></tr></table></figure><h2 id="第六节-拓展配置"><a href="#第六节-拓展配置" class="headerlink" title="第六节 拓展配置"></a>第六节 拓展配置</h2><h3 id="1-创建文件"><a href="#1-创建文件" class="headerlink" title="1. 创建文件"></a>1. 创建文件</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">'USER_TYPE'</span>      =&gt; <span class="number">2</span>, <span class="comment">//用户类型</span></span><br><span class="line">    <span class="string">'USER_AUTH_ID'</span>   =&gt; <span class="number">10</span>, <span class="comment">//用户认证ID</span></span><br><span class="line">    <span class="string">'USER_AUTH_TYPE'</span> =&gt; <span class="number">2</span>, <span class="comment">//用户认证模式</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3 id="2-自定义配置文件配置"><a href="#2-自定义配置文件配置" class="headerlink" title="2. 自定义配置文件配置"></a>2. 自定义配置文件配置</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C(<span class="string">'USER_AUTH_ID'</span>);</span><br></pre></td></tr></table></figure><h2 id="第七节-批量配置"><a href="#第七节-批量配置" class="headerlink" title="第七节 批量配置"></a>第七节 批量配置</h2><h3 id="1-C方法配置"><a href="#1-C方法配置" class="headerlink" title="1. C方法配置"></a>1. C方法配置</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$config = <span class="keyword">array</span>(<span class="string">'WEB_SITE_TITLE'</span>=&gt;<span class="string">'ThinkPHP'</span>,<span class="string">'WEB_SITE_DESCRIPTION'</span>=&gt;<span class="string">'开源PHP框架'</span>);</span><br><span class="line">C($config);</span><br></pre></td></tr></table></figure><h3 id="2-读取方式"><a href="#2-读取方式" class="headerlink" title="2.读取方式"></a>2.读取方式</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 读取数据库中的配置（假设有一个config表用于保存配置参数）</span></span><br><span class="line">$config =   M(<span class="string">'Config'</span>)-&gt;getField(<span class="string">'name,value'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// config是一个关联数组 键值就是配置参数 值就是配置值</span></span><br><span class="line"><span class="comment">// 例如： array('config1'=&gt;'val1','config2'=&gt;'val2',...)</span></span><br><span class="line">C($config); <span class="comment">// 合并配置参数到全局配置</span></span><br></pre></td></tr></table></figure><h1 id="第四章-架构"><a href="#第四章-架构" class="headerlink" title="第四章 架构"></a>第四章 架构</h1><h2 id="第一节-模块化设计"><a href="#第一节-模块化设计" class="headerlink" title="第一节 模块化设计"></a>第一节 模块化设计</h2><h3 id="1-设计方式"><a href="#1-设计方式" class="headerlink" title="1. 设计方式"></a>1. 设计方式</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//localhost/index.php（或者其他应用入口文件）/模块/控制器/操作/[参数名/参数值...]</span></span><br></pre></td></tr></table></figure><table><thead><tr><th>名称</th><th>描述</th></tr></thead><tbody><tr><td>应用</td><td>基于同一个入口文件访问的项目我们称之为一个应用。</td></tr><tr><td>模块</td><td>一个应用下面可以包含多个模块，每个模块在应用目录下面都是一个独立的子目录。</td></tr><tr><td>控制器</td><td>每个模块可以包含多个控制器，一个控制器通常体现为一个控制器类。</td></tr><tr><td>操作</td><td>每个控制器类可以包含多个操作方法，也可能是绑定的某个操作类，每个操作是URL访问的最小单元。</td></tr></tbody></table><h3 id="2-公共模块"><a href="#2-公共模块" class="headerlink" title="2. 公共模块"></a>2. 公共模块</h3><blockquote><p>Common模块是一个特殊的模块，是应用的公共模块，访问所有的模块之前都会首先加载公共模块下面的配置文件（<code>Conf/config.php</code>）和公共函数文件（<code>Common/function.php</code>）。但Common模块本身不能通过URL直接访问，公共模块的其他文件则可以被其他模块继承或者调用。</p></blockquote><h3 id="3-改变公共模块"><a href="#3-改变公共模块" class="headerlink" title="3. 改变公共模块"></a>3. 改变公共模块</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">define(<span class="string">'COMMON_PATH'</span>,<span class="string">'./Common/'</span>);</span><br><span class="line">define(<span class="string">'APP_PATH'</span>,<span class="string">'./Application/'</span>);</span><br><span class="line"><span class="keyword">require</span> <span class="string">'./ThinkPHP/ThinkPHP.php'</span>;</span><br></pre></td></tr></table></figure><blockquote><p>改变之后，期目录结构就变成了</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">www  WEB部署目录（或者子目录）</span><br><span class="line">├─index.php       入口文件</span><br><span class="line">├─README.md       README文件</span><br><span class="line">├─Common          应用公共模块目录</span><br><span class="line">├─Application     应用模块目录</span><br><span class="line">├─<span class="keyword">Public</span>          应用资源文件目录</span><br><span class="line">└─ThinkPHP        框架目录</span><br></pre></td></tr></table></figure><h2 id="第二节-URL模式"><a href="#第二节-URL模式" class="headerlink" title="第二节 URL模式"></a>第二节 URL模式</h2><h3 id="1-参考"><a href="#1-参考" class="headerlink" title="1. 参考"></a>1. 参考</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//serverName/index.php/模块/控制器/操作</span></span><br></pre></td></tr></table></figure><h3 id="2-URL大小写"><a href="#2-URL大小写" class="headerlink" title="2. URL大小写"></a>2. URL大小写</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'URL_CASE_INSENSITIVE'</span>  =&gt;  <span class="keyword">true</span></span><br></pre></td></tr></table></figure><h3 id="3-不同模式"><a href="#3-不同模式" class="headerlink" title="3. 不同模式"></a>3. 不同模式</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//serverName/index.php</span></span><br><span class="line">http:<span class="comment">//serverName/index.php/Home/Index/index</span></span><br></pre></td></tr></table></figure><table><thead><tr><th>URL模式</th><th>URL_MODEL设置</th></tr></thead><tbody><tr><td>普通模式</td><td>0</td></tr><tr><td>PATHINFO模式</td><td>1</td></tr><tr><td>REWRITE模式</td><td>2</td></tr><tr><td>兼容模式</td><td>3</td></tr></tbody></table><h2 id="第三节-命名空间"><a href="#第三节-命名空间" class="headerlink" title="第三节 命名空间"></a>第三节 命名空间</h2><blockquote><p>3.2版本全面采用命名空间方式定义和加载类库文件，有效的解决多个模块之间的冲突问题，并且实现了更加高效的类库自动加载机制。</p></blockquote><blockquote><p>命名空间的概念必须了解，否则会成为3.2版本开发的重大障碍。<br>如果不清楚什么是命名空间，可以参考PHP手册：<a href="http://www.php.net/manual/zh/language.namespaces.php" target="_blank" rel="noopener">PHP命名空间</a></p></blockquote><blockquote><p>由于新版完全采用了命名空间的特性，因此只需要给类库正确定义所在的命名空间，而命名空间的路径与类库文件的目录一致，那么就可以实现类的自动加载。 例如，<code>Org\Util\File</code>类的定义为：</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Org</span>\<span class="title">Util</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">File</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>其所在的路径是 <code>ThinkPHP/Library/Org/Util/File.class.php</code>，因此，如果我们实例化该类的话：</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$class = <span class="keyword">new</span> \Org\Util\File();</span><br></pre></td></tr></table></figure><blockquote><p>系统会自动加载 <code>ThinkPHP/Library/Org/Util/File.class.php</code> 文件。</p></blockquote><h1 id="第五章-控制器"><a href="#第五章-控制器" class="headerlink" title="第五章 控制器"></a>第五章 控制器</h1><h2 id="第一节-控制器定义"><a href="#第一节-控制器定义" class="headerlink" title="第一节 控制器定义"></a>第一节 控制器定义</h2><h3 id="1-定义方式"><a href="#1-定义方式" class="headerlink" title="1. 定义方式"></a>1. 定义方式</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Home</span>\<span class="title">Controller</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Think</span>\<span class="title">Controller</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IndexController</span> <span class="keyword">extends</span> <span class="title">Controller</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'hello,兄弟们好!'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>接下来我们访问 <a href="http://web1709.com/index.php/Home/Index/hello" target="_blank" rel="noopener">http://web1709.com/index.php/Home/Index/hello</a></p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hello,兄弟们好！</span><br></pre></td></tr></table></figure><h3 id="2-后缀"><a href="#2-后缀" class="headerlink" title="2.后缀"></a>2.后缀</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'ACTION_SUFFIX'</span>         =&gt;  <span class="string">'Action'</span>, <span class="comment">// 操作方法后缀</span></span><br></pre></td></tr></table></figure><blockquote><p>设置操作方法的后缀为Action，这样，控制器的操作方法定义调整为：</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Home</span>\<span class="title">Controller</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Think</span>\<span class="title">Controller</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IndexController</span> <span class="keyword">extends</span> <span class="title">Controller</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">listAction</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'list'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">helloAction</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'hello'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">testAction</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'test'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="第二节-前置和后置操作"><a href="#第二节-前置和后置操作" class="headerlink" title="第二节 前置和后置操作"></a>第二节 前置和后置操作</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Home</span>\<span class="title">Controller</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Think</span>\<span class="title">Controller</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IndexController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span>&#123;</span><br><span class="line">    <span class="comment">//前置操作方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">_before_index</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'before&lt;br/&gt;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'index&lt;br/&gt;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//后置操作方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">_after_index</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'after&lt;br/&gt;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>如果我们访问 <code>http://serverName/index.php/Home/Index/index</code></p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">before</span><br><span class="line">index</span><br><span class="line">after</span><br></pre></td></tr></table></figure><h2 id="第三节-Action参数绑定"><a href="#第三节-Action参数绑定" class="headerlink" title="第三节 Action参数绑定"></a>第三节 Action参数绑定</h2><h3 id="1-启动"><a href="#1-启动" class="headerlink" title="1. 启动"></a>1. 启动</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'URL_PARAMS_BIND'</span>       =&gt;  <span class="keyword">true</span>, <span class="comment">// URL变量绑定到操作方法作为参数</span></span><br></pre></td></tr></table></figure><h3 id="2-按变量名绑定"><a href="#2-按变量名绑定" class="headerlink" title="2. 按变量名绑定"></a>2. 按变量名绑定</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Home</span>\<span class="title">Controller</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Think</span>\<span class="title">Controller</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BlogController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span><span class="params">($id)</span></span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'id='</span>.$id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">archive</span><span class="params">($year=<span class="string">'2013'</span>,$month=<span class="string">'01'</span>)</span></span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'year='</span>.$year.<span class="string">'&amp;month='</span>.$month;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="第四节-伪静态"><a href="#第四节-伪静态" class="headerlink" title="第四节 伪静态"></a>第四节 伪静态</h2><h3 id="1-设置方式"><a href="#1-设置方式" class="headerlink" title="1. 设置方式"></a>1. 设置方式</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'URL_HTML_SUFFIX'</span>=&gt;<span class="string">'shtml'</span></span><br></pre></td></tr></table></figure><h3 id="2-默认值"><a href="#2-默认值" class="headerlink" title="2. 默认值"></a>2. 默认值</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'URL_HTML_SUFFIX'</span>=&gt;<span class="string">''</span></span><br></pre></td></tr></table></figure><h2 id="第五节-跳转和重定向"><a href="#第五节-跳转和重定向" class="headerlink" title="第五节 跳转和重定向"></a>第五节 跳转和重定向</h2><h3 id="1-成功失败跳转"><a href="#1-成功失败跳转" class="headerlink" title="1. 成功失败跳转"></a>1. 成功失败跳转</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$User = M(<span class="string">'User'</span>); <span class="comment">//实例化User对象</span></span><br><span class="line">$result = $User-&gt;add($data); </span><br><span class="line"><span class="keyword">if</span>($result)&#123;</span><br><span class="line">    <span class="comment">//设置成功后跳转页面的地址，默认的返回页面是$_SERVER['HTTP_REFERER']</span></span><br><span class="line">    <span class="keyword">$this</span>-&gt;success(<span class="string">'新增成功'</span>, <span class="string">'User/list'</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">//错误页面的默认跳转页面是返回前一页，通常不需要设置</span></span><br><span class="line">    <span class="keyword">$this</span>-&gt;error(<span class="string">'新增失败'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="1-1-方法一"><a href="#1-1-方法一" class="headerlink" title="1. 1 方法一"></a>1. 1 方法一</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 操作完成3秒后跳转到 /Article/index</span></span><br><span class="line"><span class="keyword">$this</span>-&gt;success(<span class="string">'操作完成'</span>,<span class="string">'/Article/index'</span>,<span class="number">3</span>);</span><br><span class="line"><span class="comment">// 操作失败5秒后跳转到 /Article/error</span></span><br><span class="line"><span class="keyword">$this</span>-&gt;error(<span class="string">'操作失败'</span>,<span class="string">'/Article/error'</span>,<span class="number">5</span>);</span><br></pre></td></tr></table></figure><h4 id="1-2-方法二"><a href="#1-2-方法二" class="headerlink" title="1.2 方法二"></a>1.2 方法二</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//默认错误跳转对应的模板文件</span></span><br><span class="line"><span class="string">'TMPL_ACTION_ERROR'</span> =&gt; <span class="string">'Public:error'</span>;</span><br><span class="line"><span class="comment">//默认成功跳转对应的模板文件</span></span><br><span class="line"><span class="string">'TMPL_ACTION_SUCCESS'</span> =&gt; <span class="string">'Public:success'</span>;</span><br></pre></td></tr></table></figure><h4 id="1-3-自定义设置模板信息"><a href="#1-3-自定义设置模板信息" class="headerlink" title="1.3 自定义设置模板信息"></a>1.3 自定义设置模板信息</h4><table><thead><tr><th>变量</th><th>含义</th></tr></thead><tbody><tr><td>$msgTitle</td><td>操作标题</td></tr><tr><td>$message</td><td>页面提示信息</td></tr><tr><td>$status</td><td>操作状态 1表示成功 0 表示失败 具体还可以由项目本身定义规则</td></tr><tr><td>$waitSecond</td><td>跳转等待时间 单位为秒</td></tr><tr><td>$jumpUrl</td><td>跳转页面地址</td></tr></tbody></table><ul><li>success和error方法会自动判断当前请求是否属于Ajax请求，如果属于Ajax请求则会调用ajaxReturn方法返回信息。 ajax方式下面，success和error方法会封装下面的数据返回：</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$data[<span class="string">'info'</span>]   =   $message; <span class="comment">// 提示信息内容</span></span><br><span class="line">$data[<span class="string">'status'</span>] =   $status;  <span class="comment">// 状态 如果是success是1 error 是0</span></span><br><span class="line">$data[<span class="string">'url'</span>]    =   $jumpUrl; <span class="comment">// 成功或者错误的跳转地址</span></span><br></pre></td></tr></table></figure><h3 id="2-重定向"><a href="#2-重定向" class="headerlink" title="2. 重定向"></a>2. 重定向</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//重定向到New模块的Category操作</span></span><br><span class="line"><span class="keyword">$this</span>-&gt;redirect(<span class="string">'New/category'</span>, <span class="keyword">array</span>(<span class="string">'cate_id'</span> =&gt; <span class="number">2</span>), <span class="number">5</span>, <span class="string">'页面跳转中...'</span>);</span><br></pre></td></tr></table></figure><blockquote><p>如果你仅仅是想重定向要一个指定的URL地址，而不是到某个模块的操作方法，可以直接使用<code>redirect</code>函数重定向，例如：</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//重定向到指定的URL地址</span></span><br><span class="line">redirect(<span class="string">'/New/category/cate_id/2'</span>, <span class="number">5</span>, <span class="string">'页面跳转中...'</span>)</span><br></pre></td></tr></table></figure><h2 id="第六节-输入变量"><a href="#第六节-输入变量" class="headerlink" title="第六节 输入变量"></a>第六节 输入变量</h2><h3 id="1-获取变量"><a href="#1-获取变量" class="headerlink" title="1. 获取变量"></a>1. 获取变量</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$id    =  $_GET[<span class="string">'id'</span>]; <span class="comment">// 获取get变量</span></span><br><span class="line">$name  =  $_POST[<span class="string">'name'</span>];  <span class="comment">// 获取post变量</span></span><br><span class="line">$value =  $_SESSION[<span class="string">'var'</span>]; <span class="comment">// 获取session变量</span></span><br><span class="line">$name  =  $_COOKIE[<span class="string">'name'</span>]; <span class="comment">// 获取cookie变量</span></span><br><span class="line">$file  =  $_SERVER[<span class="string">'PHP_SELF'</span>]; <span class="comment">// 获取server变量</span></span><br></pre></td></tr></table></figure><h3 id="2-I方法使用"><a href="#2-I方法使用" class="headerlink" title="2. I方法使用"></a>2. I方法使用</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">I(<span class="string">'变量类型.变量名/修饰符'</span>,[<span class="string">'默认值'</span>],[<span class="string">'过滤方法'</span>],[<span class="string">'额外数据源'</span>])</span><br></pre></td></tr></table></figure><blockquote><p>变量类型是指请求方式或者输入类型，包括：</p></blockquote><table><thead><tr><th>变量类型</th><th>含义</th></tr></thead><tbody><tr><td>get</td><td>获取GET参数</td></tr><tr><td>post</td><td>获取POST参数</td></tr><tr><td>param</td><td>自动判断请求类型获取GET、POST或者PUT参数</td></tr><tr><td>request</td><td>获取REQUEST 参数</td></tr><tr><td>put</td><td>获取PUT 参数</td></tr><tr><td>session</td><td>获取 $_SESSION 参数</td></tr><tr><td>cookie</td><td>获取 $_COOKIE 参数</td></tr><tr><td>server</td><td>获取 $_SERVER 参数</td></tr><tr><td>globals</td><td>获取 $GLOBALS参数</td></tr><tr><td>path</td><td>获取 PATHINFO模式的URL参数<strong>（3.2.2新增）</strong></td></tr><tr><td>data</td><td>获取 其他类型的参数，需要配合额外数据源参数<strong>（3.2.2新增）</strong></td></tr></tbody></table><h3 id="3-变量过滤"><a href="#3-变量过滤" class="headerlink" title="3. 变量过滤"></a>3. 变量过滤</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 系统默认的变量过滤机制</span></span><br><span class="line"><span class="string">'DEFAULT_FILTER'</span>        =&gt; <span class="string">'htmlspecialchars'</span></span><br></pre></td></tr></table></figure><blockquote><p>也就说，I方法的所有获取变量如果没有设置过滤方法的话都会进行htmlspecialchars过滤，那么：</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 等同于 htmlspecialchars($_GET['name'])</span></span><br><span class="line">I(<span class="string">'get.name'</span>);</span><br></pre></td></tr></table></figure><blockquote><p>同样，该参数也可以设置支持多个过滤，例如：</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'DEFAULT_FILTER'</span>        =&gt; <span class="string">'strip_tags,htmlspecialchars'</span></span><br></pre></td></tr></table></figure><blockquote><p>设置后，我们在使用：</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 等同于 htmlspecialchars(strip_tags($_GET['name']))</span></span><br><span class="line">I(<span class="string">'get.name'</span>);</span><br></pre></td></tr></table></figure><blockquote><p>如果我们在使用I方法的时候 指定了过滤方法，那么就会忽略DEFAULT_FILTER的设置，例如：</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 等同于 strip_tags($_GET['name'])</span></span><br><span class="line"><span class="keyword">echo</span> I(<span class="string">'get.name'</span>,<span class="string">''</span>,<span class="string">'strip_tags'</span>);</span><br></pre></td></tr></table></figure><blockquote><p>表示 会对<code>$_POST[&#39;email&#39;]</code> 进行 格式验证，如果不符合要求的话，返回空字符串。 （关于更多的验证格式，可以参考 官方手册的<code>filter_var</code>用法。） 或者可以用下面的字符标识方式：</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">I(<span class="string">'post.email'</span>,<span class="string">''</span>,<span class="string">'email'</span>);</span><br></pre></td></tr></table></figure><blockquote><p>可以支持的过滤名称必须是<code>filter_list</code>方法中的有效值（不同的服务器环境可能有所不同），可能支持的包括：</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">int</span><br><span class="line">boolean</span><br><span class="line">float</span><br><span class="line">validate_regexp</span><br><span class="line">validate_url</span><br><span class="line">validate_email</span><br><span class="line">validate_ip</span><br><span class="line">string</span><br><span class="line">stripped</span><br><span class="line">encoded</span><br><span class="line">special_chars</span><br><span class="line">unsafe_raw</span><br><span class="line">email</span><br><span class="line">url</span><br><span class="line">number_int</span><br><span class="line">number_float</span><br><span class="line">magic_quotes</span><br><span class="line">callback</span><br></pre></td></tr></table></figure><blockquote><p>3.2.3版本开始支持进行正则匹配过滤，例如：</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 采用正则表达式进行变量过滤</span></span><br><span class="line">I(<span class="string">'get.name'</span>,<span class="string">''</span>,<span class="string">'/^[A-Za-z]+$/'</span>);</span><br><span class="line">I(<span class="string">'get.id'</span>,<span class="number">0</span>,<span class="string">'/^\d+$/'</span>);</span><br></pre></td></tr></table></figure><h2 id="第七节-请求类型"><a href="#第七节-请求类型" class="headerlink" title="第七节 请求类型"></a>第七节 请求类型</h2><table><thead><tr><th>常量</th><th>说明</th></tr></thead><tbody><tr><td>IS_GET</td><td>判断是否是GET方式提交</td></tr><tr><td>IS_POST</td><td>判断是否是POST方式提交</td></tr><tr><td>IS_PUT</td><td>判断是否是PUT方式提交</td></tr><tr><td>IS_DELETE</td><td>判断是否是DELETE方式提交</td></tr><tr><td>IS_AJAX</td><td>判断是否是AJAX提交</td></tr><tr><td>REQUEST_METHOD</td><td>当前提交类型</td></tr></tbody></table><blockquote><p>例如：</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span>&#123;</span><br><span class="line">     <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span><span class="params">()</span></span>&#123;</span><br><span class="line">         <span class="keyword">if</span> (IS_POST)&#123;</span><br><span class="line">             $User = M(<span class="string">'User'</span>);</span><br><span class="line">             $User-&gt;create();</span><br><span class="line">             $User-&gt;save();</span><br><span class="line">             <span class="keyword">$this</span>-&gt;success(<span class="string">'保存完成'</span>);</span><br><span class="line">         &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">             <span class="keyword">$this</span>-&gt;error(<span class="string">'非法请求'</span>);</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="第八节-空操作"><a href="#第八节-空操作" class="headerlink" title="第八节 空操作"></a>第八节 空操作</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Home</span>\<span class="title">Controller</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Think</span>\<span class="title">Controller</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CityController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">_empty</span><span class="params">($name)</span></span>&#123;</span><br><span class="line">        <span class="comment">//把所有城市的操作解析到city方法</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;city($name);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//注意 city方法 本身是 protected 方法</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">city</span><span class="params">($name)</span></span>&#123;</span><br><span class="line">        <span class="comment">//和$name这个城市相关的处理</span></span><br><span class="line">         <span class="keyword">echo</span> <span class="string">'当前城市'</span> . $name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="第九节-空控制器"><a href="#第九节-空控制器" class="headerlink" title="第九节 空控制器"></a>第九节 空控制器</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//serverName/index.php/Home/City/shanghai/</span></span><br></pre></td></tr></table></figure><blockquote><p>变成</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//serverName/index.php/Home/shanghai/</span></span><br></pre></td></tr></table></figure><blockquote><p>我们可以给项目定义一个EmptyController类</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Home</span>\<span class="title">Controller</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Think</span>\<span class="title">Controller</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EmptyController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//根据当前控制器名来判断要执行那个城市的操作</span></span><br><span class="line">        $cityName = CONTROLLER_NAME;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;city($cityName);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//注意 city方法 本身是 protected 方法</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">city</span><span class="params">($name)</span></span>&#123;</span><br><span class="line">        <span class="comment">//和$name这个城市相关的处理</span></span><br><span class="line">         <span class="keyword">echo</span> <span class="string">'当前城市'</span> . $name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>接下来，我们就可以在浏览器里面输入</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//serverName/index.php/Home/beijing/</span></span><br><span class="line">http:<span class="comment">//serverName/index.php/Home/shanghai/</span></span><br><span class="line">http:<span class="comment">//serverName/index.php/Home/shenzhen/</span></span><br></pre></td></tr></table></figure><blockquote><p>由于系统并不存在beijing、shanghai或者shenzhen控制器，因此会定位到空控制器（EmptyController）去执行，会看到依次输出的结果是：</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">当前城市:beijing</span><br><span class="line">当前城市:shanghai</span><br><span class="line">当前城市:shenzhen</span><br></pre></td></tr></table></figure></div><footer class="article-footer"><a data-url="http://www.JiShuXuePai.com/tech/thinkphp/notes.html" data-id="cjh1rl6p0003ytqfytsyo1fl2" class="article-share-link"><i class="fa fa-share"></i>分享到</a><script>!function(n){n("body").on("click",function(){n(".article-share-box.on").removeClass("on")}).on("click",".article-share-link",function(t){t.stopPropagation();var e,a=n(this),o=a.attr("data-url"),r=encodeURIComponent(o),i="article-share-box-"+a.attr("data-id"),s=a.offset();if(n("#"+i).length){if((e=n("#"+i)).hasClass("on"))return void e.removeClass("on")}else{var l=['<div id="'+i+'" class="article-share-box">','<input class="article-share-input" value="'+o+'">','<div class="article-share-links">','<a href="https://twitter.com/intent/tweet?url='+r+'" class="article-share-twitter" target="_blank" title="Twitter"></a>','<a href="https://www.facebook.com/sharer.php?u='+r+'" class="article-share-facebook" target="_blank" title="Facebook"></a>','<a href="http://pinterest.com/pin/create/button/?url='+r+'" class="article-share-pinterest" target="_blank" title="Pinterest"></a>','<a href="https://plus.google.com/share?url='+r+'" class="article-share-google" target="_blank" title="Google+"></a>',"</div>","</div>"].join("");e=n(l),n("body").append(e)}n(".article-share-box.on").hide(),e.css({top:s.top+25,left:s.left}).addClass("on")}).on("click",".article-share-box",function(t){t.stopPropagation()}).on("click",".article-share-box-input",function(){n(this).select()}).on("click",".article-share-box-link",function(t){t.preventDefault(),t.stopPropagation(),window.open(this.href,"article-share-box-window-"+Date.now(),"width=500,height=450")})}(jQuery)</script></footer></div></article><section id="comments"><div id="gitalk_frame"></div></section></div></section><aside id="sidebar"><a class="sidebar-toggle" title="Expand Sidebar"><i class="toggle icon"></i></a><div class="sidebar-top"><p>关注我 :</p><ul class="social-links"><li><a class="social-tooltip" title="火星时代" href="http://edu.hxsd.com/edunew/topics/webfull/index.html" target="_blank"><i class="icon fa fa-dribbble"></i></a></li><li><a class="social-tooltip" title="weibo" href="#" target="_blank"><i class="icon fa fa-weibo"></i></a></li><li><a class="social-tooltip" title="rss" href="/atom.xml" target="_blank"><i class="icon fa fa-rss"></i></a></li></ul></div><div class="widgets-container"><link rel="stylesheet" href="/css/tech/toc.css"><div class="widget-wrap widget-list widget-toc"><h3 class="widget-title">目录</h3><div class="widget"><div class="toc"></div><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/3.0.5/tocbot.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/3.0.5/tocbot.min.js"></script><script>$(function(){$(".main-body-content").find("h1,h2,h3").each(function(t){$(this).attr("id")||$(this).attr("id","list"+t)}),tocbot.init({tocSelector:".toc",contentSelector:".main-body-content",headingSelector:"h1, h2, h3",collapseDepth:2,positionFixedSelector:".widget-toc",fixedSidebarOffset:595,includeHtml:!1})})</script></div></div><div class="widget-wrap widget-list"><h3 class="widget-title">链接</h3><div class="widget"><ul><li><a href="http://edu.hxsd.com/edunew/topics/webfull/index.html">火星时代</a></li></ul></div></div></div></aside><script>$(function(){$(window).scroll(function(){240<=$(document).scrollTop()?($("#sidebar .sidebar-toggle").addClass("fix"),"block"==$("#sidebar .sidebar-toggle").css("display")&&$(".is-position-fixed").css("top","35px")):$("#sidebar .sidebar-toggle").removeClass("fix")})})</script></div></div></div><footer id="footer"><div class="top"><div class="inner"><div class="list"><dl><dt>关于我们</dt><dd><a href="edu/index.html">公司简介</a></dd><dd><a href="edu/index.html">联系我们</a></dd></dl><dl><dt>校区攻略</dt><dd><a href="edu/index.html">校区环境</a></dd><dd><a href="edu/index.html">住宿攻略</a></dd><dd><a href="edu/index.html">来校路线</a></dd></dl><dl><dt>课程培训</dt><dd><a href="edu/python.html">Web前端</a></dd><dd><a href="edu/python.html">Python</a></dd><dd><a href="edu/python.html">人工智能</a></dd><dd><a href="edu/python.html">大数据</a></dd></dl><dl><dt>常见问答</dt><dd><a href="edu/index.html">学费学时</a></dd><dd><a href="edu/index.html">学习方法</a></dd></dl></div><div class="tel"><img src="css/images/phone.png"><tel>176-0025-8815</tel><span>北京市海淀区杏石口路81号火星时代大厦</span></div><div class="weixin"><div class="w1"><img src="css/images/weixin.png"> <span>官方微信</span></div></div></div></div><div class="bot">Copyright 2018 技术学派 京ICP备15015508号-3</div></footer><link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css"><script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script><script>var gitalk=new Gitalk({clientID:"2fbbb9980b49019d99a7",clientSecret:"152dd10e83ef6595761ea2185304f9ac8263573f",repo:"jsxp",owner:"li-kang",admin:["li-kang"]});gitalk.render("gitalk_frame")</script><script src="/libs/lightgallery/js/lightgallery.min.js"></script><script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script><script src="/libs/lightgallery/js/lg-pager.min.js"></script><script src="/libs/lightgallery/js/lg-autoplay.min.js"></script><script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script><script src="/libs/lightgallery/js/lg-zoom.min.js"></script><script src="/libs/lightgallery/js/lg-hash.min.js"></script><script src="/libs/lightgallery/js/lg-share.min.js"></script><script src="/libs/lightgallery/js/lg-video.min.js"></script><script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="/js/main.js"></script></div></body>